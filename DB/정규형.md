## 정규형

### 정규화란?

함수 종속성을 이용해 릴레이션을 연관성이 있는 속성들로만 구성되도록 분해하는 작업으로 이상현상이 없는 바른 릴레이션으로 만드는 것이 목표입니다.

여기서 정규화를 한 후 릴레이션은 손실 없이 분해가 되어야 하며 분해된 릴레이션들은 자연조인을 했을 시 분해 전으로 복원 가능해야 합니다.

> 기본 정규형(1, 2, 3, 보이스/코드)과 고급 정규형(4, 5) 가 있습니다. 대부분의 내용은 기본 정규형으로 다루도록 하겠습니다.

### 제 1 정규형

각 칼럼이 하나의 속성만을 가지게 해야 합니다.

| ID  | EVENTNUM |
| --- | -------- |
| Wow | 1, 2, 4  |

위에서는 EventNum에 1, 2, 4가 있어 제 1 정규형을 만족하지 않습니다.

| ID  | EVENTNUM |
| --- | -------- |
| Wow | 1        |
| Wow | 2        |
| Wow | 4        |

이런 식으로 분리해야 합니다.

### 제 2 정규형

제 1 정규형에 속하고 **기본키가 아닌 속성이 모두 기본키에 완전 종속되는 경우**를 이야기 합니다.

| ID    | EVENTNUM | GRADE | PERCENT |
| ----- | -------- | ----- | ------- |
| Wow   | 1        | P     | 20%     |
| Wow   | 2        | P     | 20%     |
| Great | 7        | G     | 10%     |

라는 릴레이션이 있을 때 `부분 함수 종속성`을 제거해야 합니다.

| ID    | EVENTNUM |
| ----- | -------- |
| Wow   | 1        |
| Wow   | 2        |
| Great | 7        |

| ID    | GRADE | PERCENT |
| ----- | ----- | ------- |
| Wow   | P     | 20%     |
| Great | G     | 10%     |

이런 식으로 모든 속성이 기본키에 완전 종속되게 변경해주는게 제 정규화 작업입니다.

### 제 3 정규형

제 3 정규형은 제 2 정규형에서 `이행적 함수 종속`을 제거한 것입니다.

| ID    | GRADE | PERCENT |
| ----- | ----- | ------- |
| Wow   | P     | 20%     |
| Great | G     | 10%     |

위 제 2 정규형을 거친 릴레이션에서 문제는 `이행적 함수 종속`이 있다는 것입니다.

>  `이행적 함수 종속` 이란 릴레이션을 구성하는 속성 X, Y, Z 에서 X > Y, Y > Z 이면 X > Z 가 되는데 이 경우 Z가 X에 이행적으로 함수 종속되었다고 합니다.

위 릴레이션에서는 ID를 통해 GRADE를 알 수 있고 GRADE 에서 PERCENT를 알 수 있습니다. 때문에 이들을 분해하는 작업이 필요합니다.

| ID    | GRADE |
| ----- | ----- |
| Wow   | P     |
| Great | G     |

| GRADE | PERCENT |
| ----- | ------- |
| P     | 20%     |
| G     | 10%     |

이렇게 ID로 GRADE 만을 알 수 있고 GRADE로 PERCENT를 알 수 있습니다.

### 보이스 코드 정규형 - BCNF (Boyce Codd Normal Form)

제 3 정규형에서 더 나아가 **모든 결정자가 후보키**라면 BCNF를 만족하게 됩니다.

| ID    | SHOP | SHOP MANAGER |
| ----- | ---- | ------------ |
| Wow   | GS35 | Tom          |
| Great | FU   | Hardy        |

여기서 기본키는 ID 와 SHOP이 됩니다. ID를 담당하는 SHOP MANAGER가 있어야 하고 SHOP을 관리하는 SHOP MANAGER가 있는 것입니다.

이런 경우가 있다면 만일 Wow 고객이 FU로 가게를 변경했음에도 SHOP MANAGER가 그대로 있어 데이터 불일치가 있을 수 있으며 삽입, 삭제 시에도 신경써야 할 부분이 늘어나게 됩니다.

역시나 해결법은 분리를 하는 것입니다.

| ID    | SHOP |
| ----- | ---- |
| Wow   | GS35 |
| Great | FU   |

| SHOP MANAGER | SHOP |
| ------------ | ---- |
| Tom          | GS35 |
| Hardy        | FU   |

이런식으로 분리를 하면 됩니다.

### 제 4, 5 정규형

- 제 4 정규형 : BCNF 를 만족하면서 함수 종속이 아닌 다치 종속을 제거하면 만족

- 제 5 정규형 : 제 4 정규형을 만족하면서 후보키를 통하지 않는 조인 종속을 제거하면 만족
