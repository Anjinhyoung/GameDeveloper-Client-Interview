# C#의 string



C#에서의 string은 immutable(불변) 속성을 가지고 있습니다. string이 이렇게 불변속성이 된 이유는 멀티스레드 환경을 고려해 여러 스레드들이 엑세스 할 때 이들에 대한 동기화 처리를 하는 것보다 변경이 안되게 **읽기 전용**으로 만드는게 값이 더 싸다고 생각한 것입니다.

때문에 string에 대한 조작(+=, -= 등)을 하게 되면 이전의 객체에서 복사 후 연산을 한 뒤 이를 대입해주므로 이전의 객체는 가비지가 되어 이후 GC의 처리를 받게 됩니다. 때문에 수정이 많이 일어나는 문자열로 예상이 된다면 `StringBuilder`등의 클래스를 사용하는게 좋습니다.



## StringBuilder는 어떻게 string 보다 수정에 용이할까?

StringBuilder는 기본적으로 16문자를 담을 수 있는 자리를 잡습니다. 이렇게 할당 된 크기 내에서는 어떠한 수정을 해도 가비지가 생성되지 않습니다.

만일 미리 할당한 버퍼가 다 찬 상태에서 append를 하게 되면 **새 버퍼를 할당한 뒤 버퍼간 링크를 구성**한다고 합니다.

> 다만 .Net 4.0 이전은 C++ vector 처럼 이전의 버퍼를 GC로 넘기고 새 버퍼를 할당하는 방식으로 했습니다.